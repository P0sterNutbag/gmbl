[gd_scene load_steps=12 format=3 uid="uid://cb05x24r4r8im"]

[ext_resource type="Script" uid="uid://ba01kvx1jag3c" path="res://Scripts/enemy.gd" id="1_1f0kj"]
[ext_resource type="Script" uid="uid://cdgvftnrtwbf7" path="res://Scripts/health_component.gd" id="2_afpow"]
[ext_resource type="PackedScene" uid="uid://d5w6yrf03c0w" path="res://Art/Models/enemy_model.tscn" id="2_haro7"]
[ext_resource type="Script" uid="uid://ccu856f1csrwx" path="res://Scripts/shoot_component.gd" id="3_afpow"]
[ext_resource type="Script" uid="uid://c338ifvm4duar" path="res://Scripts/bullet_stats.gd" id="5_ghaa6"]
[ext_resource type="Script" uid="uid://but6ijlpfowbx" path="res://Scripts/detection_component.gd" id="6_ghaa6"]
[ext_resource type="Texture2D" uid="uid://blri7djde63q7" path="res://Art/Textures/bullet hole.png" id="6_po0sg"]
[ext_resource type="Script" uid="uid://b1e6c1crno50r" path="res://Scripts/fade_them_destroy.gd" id="7_haro7"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_o06y3"]

[sub_resource type="PackedScene" id="PackedScene_56vhr"]
_bundled = {
"conn_count": 2,
"conns": PackedInt32Array(2, 0, 16, 15, 2, 0, 0, 2, 2, 16, 17, 2, 0, 0),
"editable_instances": [],
"names": PackedStringArray("Hitmarker", "Node3D", "Sprite3D", "transform", "visible", "texture", "Timer", "wait_time", "one_shot", "autostart", "script", "sprite_to_fade", "Decal", "size", "texture_albedo", "_on_timer_timeout", "timeout", "_on_timeout"),
"node_count": 4,
"node_paths": [],
"nodes": PackedInt32Array(-1, -1, 1, 0, -1, 0, 0, 0, 0, 2, 2, -1, 3, 3, 0, 4, 1, 5, 2, 0, 0, 0, 6, 6, -1, 5, 7, 3, 8, 4, 9, 4, 10, 5, 1073741835, 6, 0, 0, 0, 12, 12, -1, 2, 13, 7, 14, 2, 0),
"variants": [Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, -0.001), false, ExtResource("6_po0sg"), 5.0, true, ExtResource("7_haro7"), NodePath("../Sprite3D"), Vector3(0.1, 0.1, 0.1)],
"version": 3
}

[sub_resource type="Resource" id="Resource_po0sg"]
script = ExtResource("5_ghaa6")
speed = 50.0
max_drop_speed = 0.0
min_drop_speed = 0.0
drop_speed = 0.0
damage = 1.0
h_angle_variance = 1.0
v_angle_variance = 1.0
is_hitscan = false
bullet_drop = true
collision_mask = 4
hitmarker = SubResource("PackedScene_56vhr")
metadata/_custom_type_script = "uid://c338ifvm4duar"

[node name="Enemy" type="CharacterBody3D"]
collision_layer = 2
script = ExtResource("1_1f0kj")

[node name="EnemyModel" parent="." instance=ExtResource("2_haro7")]
transform = Transform3D(-1, 0, -8.74228e-08, 0, 1, 0, 8.74228e-08, 0, -1, 0, -1, 0)

[node name="BoneAttachment3D" parent="EnemyModel/Armature/Skeleton3D" index="1"]
transform = Transform3D(-0.389447, 0.743709, -0.543348, 0.435632, 0.668501, 0.60277, 0.811514, -0.00195316, -0.584329, -20.8788, 37.7992, -124.064)

[node name="AssaultRifle_3" parent="EnemyModel/Armature/Skeleton3D/BoneAttachment3D" index="0"]
transform = Transform3D(72.3924, -100.375, -34.9573, 34.825, 62.3596, -106.941, 100.422, 50.7332, 62.2858, 0, 0, 0)

[node name="BoneAttachment3D2" parent="EnemyModel/Armature/Skeleton3D" index="2"]
transform = Transform3D(0.787284, -0.344946, -0.511073, 0.174802, 0.919727, -0.351492, 0.591294, 0.187387, 0.784383, 29.7848, 47.2281, -114.311)

[node name="Node3D" parent="EnemyModel/Armature/Skeleton3D/BoneAttachment3D2" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 13.2921, 18.0556, 13.0293)

[node name="CollisionShape3D" type="CollisionShape3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.00301743, 0.0113287, 0.00144577)
shape = SubResource("CapsuleShape3D_o06y3")

[node name="NavigationAgent3D" type="NavigationAgent3D" parent="."]

[node name="Hitbox" type="Area3D" parent="." groups=["enemies"]]
collision_layer = 4
collision_mask = 0
script = ExtResource("2_afpow")
hp = 3.0

[node name="CollisionShape3D" type="CollisionShape3D" parent="Hitbox"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.00301743, 0.0113287, 0.00144577)
shape = SubResource("CapsuleShape3D_o06y3")

[node name="Detection" type="RayCast3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.79409, 0)
target_position = Vector3(0, 0, -50)
hit_from_inside = true
collide_with_areas = true
script = ExtResource("6_ghaa6")

[node name="ShootComponent" type="Node" parent="." node_paths=PackedStringArray("firepoint")]
script = ExtResource("3_afpow")
bullet_stats = SubResource("Resource_po0sg")
firepoint = NodePath("../EnemyModel/Armature/Skeleton3D/BoneAttachment3D/AssaultRifle_3/FirePoint")

[node name="ReturnToIdleTimer" type="Timer" parent="."]
wait_time = 5.0

[node name="PathWaitTimer" type="Timer" parent="."]
one_shot = true

[connection signal="animation_finished" from="EnemyModel/AnimationPlayer" to="." method="_on_animation_player_animation_finished"]
[connection signal="navigation_finished" from="NavigationAgent3D" to="." method="_on_navigation_agent_3d_navigation_finished"]
[connection signal="timeout" from="ReturnToIdleTimer" to="." method="_on_return_to_idle_timer_timeout"]
[connection signal="timeout" from="PathWaitTimer" to="." method="_on_path_wait_timer_timeout"]

[editable path="EnemyModel"]
[editable path="EnemyModel/Armature/Skeleton3D/BoneAttachment3D/AssaultRifle_3"]
